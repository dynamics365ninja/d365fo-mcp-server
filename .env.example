# =============================================================================
# X++ MCP Server - Development Configuration
# =============================================================================
# Copy this file to .env and update with your actual values
# For production deployment, use Azure App Service configuration

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================
# Environment: development, staging, production
NODE_ENV=development

# Server port (default: 8080)
PORT=8080

# Log level: error, warn, info, debug
LOG_LEVEL=debug

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# Path to SQLite database with indexed X++ metadata
# For development: Use local path like ./data/xpp-metadata.db
# For production: /tmp/xpp-metadata.db (ephemeral) or persistent storage
DB_PATH=./data/xpp-metadata.db

# =============================================================================
# D365 FINANCE & OPERATIONS CONNECTION (Required for metadata extraction)
# =============================================================================
# Where to find this: Azure Portal > Azure Active Directory > App registrations
# Create a new app registration for your D365 F&O environment

# Tenant ID - Find in: Azure Portal > Azure Active Directory > Overview
D365_TENANT_ID=your-tenant-id-here

# Client (Application) ID - Find in: Your app registration > Overview
D365_CLIENT_ID=your-client-id-here

# Client Secret - Find in: Your app registration > Certificates & secrets > New client secret
D365_CLIENT_SECRET=your-client-secret-here

# D365 F&O Environment URL - Your D365 environment base URL
# Example: https://mycompany.operations.dynamics.com
D365_RESOURCE_URL=https://your-environment.operations.dynamics.com

# OData API Endpoint - Usually {D365_RESOURCE_URL}/data
ODATA_ENDPOINT=https://your-environment.operations.dynamics.com/data

# =============================================================================
# METADATA EXTRACTION (For local development with D365 VM)
# =============================================================================
# Path to D365 PackagesLocalDirectory on your development VM
# Default location: C:\AOSService\PackagesLocalDirectory
PACKAGES_PATH=C:\AOSService\PackagesLocalDirectory

# Path where extracted XML metadata will be stored
METADATA_PATH=./metadata

# Comma-separated list of custom model names
# Find in: Visual Studio > Dynamics 365 > Model Management > View models
# Example: CUSTOM_MODELS=CustomModel1,CustomModel2,ApplicationSuite
CUSTOM_MODELS=YourCustomModel1,YourCustomModel2

# =============================================================================
# CUSTOM EXTENSIONS CONFIGURATION (For ISV solutions)
# =============================================================================
# Comma-separated list of custom model names to include
# Example: ISV_CustomModule1,ISV_CustomModule2,CompanyExtensions
# CUSTOM_MODELS=ISV_CustomModule1,ISV_CustomModule2

# Prefix for identifying custom extensions
# EXTENSION_PREFIX=ISV_

# Extract mode: 'all' (standard + custom), 'standard' (only standard models), 'custom' (only custom models)
# EXTRACT_MODE=all

# Compute usage statistics during database build (slow for large databases)
# COMPUTE_STATS=false

# =============================================================================
# REDIS CACHE (Optional - Improves performance)
# =============================================================================
# Enable/disable Redis caching (set to 'true' to enable)
REDIS_ENABLED=false

# Redis connection URL
# For local development: redis://localhost:6379
# For Azure: Use Azure Cache for Redis connection string
# REDIS_URL=redis://localhost:6379

# Cache TTL in seconds (default: 3600 = 1 hour)
# CACHE_TTL=3600

# Redis password (if required)
# REDIS_PASSWORD=your-redis-password

# =============================================================================
# RATE LIMITING
# =============================================================================
# Time window in milliseconds (default: 900000 = 15 minutes)
RATE_LIMIT_WINDOW_MS=900000

# Maximum requests per window per IP (default: 100)
RATE_LIMIT_MAX_REQUESTS=100

# Strict limit for expensive operations (default: 20)
RATE_LIMIT_STRICT_MAX_REQUESTS=20

# Limit for authentication attempts (default: 5)
RATE_LIMIT_AUTH_MAX_REQUESTS=5

# =============================================================================
# MEMORY OPTIMIZATION & SEARCH SUGGESTIONS
# =============================================================================
# Enable intelligent "Did you mean?" search suggestions
# When enabled, builds a term relationship graph for better suggestions
# Requires ~800MB-1.5GB heap memory depending on symbol count
# 
# Recommended settings:
# - Development: true (full features)
# - Azure Pipeline/CI: false (minimize memory)
# - Production: false or true (enable only if >2GB RAM available)
# - Docker: false (use smaller memory limits)
#
# Default: true in development, false otherwise
# ENABLE_SEARCH_SUGGESTIONS=true

# =============================================================================
# AZURE BLOB STORAGE (Optional - For cloud deployment)
# =============================================================================
# Azure Storage connection string
# Find in: Azure Portal > Storage Account > Access keys
# AZURE_STORAGE_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=youraccount;AccountKey=yourkey;EndpointSuffix=core.windows.net

# Blob container name for metadata storage
# BLOB_CONTAINER_NAME=xpp-databases

# Blob name/path for the database file
# BLOB_DATABASE_NAME=xpp-metadata.db

# =============================================================================
# APPLICATION INSIGHTS (Optional - For production monitoring)
# =============================================================================
# Find in: Azure Portal > Application Insights > Overview
# APPINSIGHTS_INSTRUMENTATIONKEY=your-instrumentation-key-here
